# 建议与愿望清单

`tailwindcss-patch` 8.0 已经可以稳定地为 Tailwind v2→v4 生成类名清单，但我们仍希望获取更多上下文信息。本页记录正在探索的方向，以及未来版本想要补充的元数据。

## 为什么需要更丰富的元数据

- **更安全的改写** —— 如果知道每个候选类名所在的文件与位置，就能精准地修改源代码，而不是做全局字符串替换。
- **更好地审计** —— 团队可以快速回答“这个类名源自哪里？”、“某个功能新增了多少类名？” 等问题，而无需重新扫描整个项目。
- **生态工具挂钩** —— 编辑器扩展或 CI 机器人可以利用这些数据提示未使用的工具类或冲突模式。

## 希望获得的候选级元数据

我们希望每个被提取的类名都能附带如下结构：

```ts
interface Candidate {
  value: string
  file: string
  start: number
  end: number
}
```

这与 UnoCSS 的 [compile-class](https://unocss.dev/transformers/compile-class) 类似，能够支撑如下的精准改写：

```diff filename="diff"
- const className = `gap-y-4 bg-zinc-800/30`
+ const className = `a b`
```

目前我们只能拿到一个 `Set<string>`，替换时必须在所有文件中尝试匹配，容易造成误伤。

## Tailwind v4 的契机

全新的 Oxide 扫描器已经在 Rust 中遍历源文件，如果它能返回文件偏移量而不是纯字符串，我们就能直接复用这些数据。相关代码位置：<https://github.com/tailwindlabs/tailwindcss/blob/437579d3f010a98ae4b824a7d5694486119fbdcd/crates/oxide/src/lib.rs#L108>。

## 欢迎一起推动

- 分享那些需要精确定位类名的真实场景。
- 试验自定义扫描或后处理脚本，并反馈你需要的接口。
- 如果在 Tailwind v4 中发现可用的挂钩，欢迎提 Issue 或 PR，帮助我们加速落地。
